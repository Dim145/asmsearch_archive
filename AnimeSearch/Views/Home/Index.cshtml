@{
    ViewData["Title"] = "Home Page";

    int nbSites = AnimeSearch.Utilities.AllSearchSite.Count + ((int)ViewData["nb_db_site"]) + 4; // Wikipedia + Nautiljon + TheMovieDB + TVMaze

    string action = "Search";
    bool old = false;
}

@using System.Globalization;

<link rel="stylesheet" href="~/css/fontwave_all.min.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/home.min.css" asp-append-version="true" />
<script type="text/javascript" src="~/js/Home.min.js" asp-append-version="true"></script>

<div class="text-center text-white">
    <h1 class="display-4">Bienvenue</h1>

    <p>
        Voir les autres <a asp-controller="home" asp-action="Domaines">adresses url</a><br />
        Utilisez <a asp-controller="home" asp-action="Contact">ce formulaire</a> pour faire remonter des bugs, faire des propositions ou autres.<br />
        Les dons Paypal et Brave (BAT) sont maintenant <a asp-controller="home" asp-action="dons">disponibles</a> (bouton orange/jaune en bas à droite).
    </p>
    <p>Ce petit site sert à rechercher des animes, des séries ou des films sur plusieurs sites différents, de streaming et/ou de téléchargement</p>
    <p>P.S: Le chargement de la page peut être TRES long, cela dépend des @nbSites+ sites externes qui sont intérogés.</p>

    @if (ViewData["old"] is not null and bool b && b)
    {
        action = "SearchSerie";
        old = true;
    }

    <div class="text-center">
        <form asp-action="@action" asp-controller="Home" method="get">
            <div class="container h-100">
                <div class="d-flex justify-content-center h-100">
                    <div class="searchbar">
                        <input id="searchBar" class="search_input text-white" type="text" name="q" placeholder="Search...">
                        <button class="search_icon float-right rounded-circle"><i class="fas fa-search"></i></button>

                        <div id="rmenu" style="display: none;" class="bg-dark border border-white rounded ">
                            <button type="submit" name="t" value="false" class="btn btn-dark w-100">Single</button>
                            <button type="submit" name="t" value="true" class="btn btn-dark w-100">Multi</button>
                        </div>

                        <div class="dcm" style="display: none;"></div>

                        <div id="propositions" class="propositions container">
                        </div>
                    </div>
                </div>
            </div>
        </form>

        @if (!old)
        {
            <div class="row mt-4">
                @if (Utilities.CITATION_DU_JOUR != null)
                {
                    <div class="col-11" title="Citation du jour. Changement quotidien">
                        <p class="w-100 text-center">@Utilities.CITATION_DU_JOUR.Contenue - @Utilities.CITATION_DU_JOUR.AuthorName </p>
                    </div>
                }
                <div class="@(Utilities.CITATION_DU_JOUR != null ? "col-lg-auto" : "") col">
                    <button href="#" data-toggle="modal" data-target="#addCit" title="proposer une citation" class="square24 border-0 rounded-circle border-white bg-success text-white text-decoration-none">+</button>
                </div>

                <!-- Modal Add cita -->
                <div class="modal fade" id="addCit" tabindex="-1" role="dialog" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content bg-dark text-white">
                            <div class="modal-header">
                                <h5 class="modal-title">Proposer une nouvelle citation</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body text-left">
                                <label for="auteur">Auteur:</label>
                                <input name="auteur" id="auteur" type="text" maxlength="50" class="w-100" />
                                <label for="contenue">Contenue:</label>
                                <input name="contenue" id="contenue" type="text" maxlength="150" class="w-100" />
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                                <button type="button" class="btn btn-primary" id="valCit" data-dismiss="modal">proposer</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<a class="d-none d-print-none" style="display: none;" href="~/" id="urlbase"></a>
<!-- Modal Settings -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content bg-dark text-white">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Ordre de recherche</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Attention, changer l'ordre peut ralentir la recherche (~3 fois plus long)</p>

                <table class="table table-dark">
                    @{
                        if (ViewData["languages"] is not null and CultureInfo[] tabCultures)
                        {
                            foreach (CultureInfo c in tabCultures)
                            {
                        <tr id="@c.EnglishName" draggable="true" ondrop="drop(event)" ondragover="allowDrop(event)" ondragstart="drag(event)"><td>@c.DisplayName</td></tr>
                            }
                        }
                    }
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                <button type="button" class="btn btn-primary" id="btnOK" data-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>

<partial name="~/Views/Shared/ModalMessage.cshtml" />


@{
    ViewData["aideHTML"] = "<p>Cette page permet de saisir une recherche. À partir de 3 caractères de saisie, des propositions sont affichées en fonction des réponses des API.</p>" +
                "<p>Les requêtes sont faites directement depuis le navigateur, le temps de réponse dépend entièrement de votre connexion internet.</ p>" +
                "<p>L'ancienne utilise un algorithme plus limité (pas de filtre et ne fonctionne que pour les séries, etc...) mais est plus rapide.</p>" +
                "<p>Avec un click droit (ou appui long sur smartphone) sur le bouton de recherche, il est possible d'effectuer une recherche multiple qui permettra de sélectionner plusieurs résultats possibles (plus détaillé).<br/>Attention, le point du dessous ne fonctionne pas avec une recherche multiple.</p>" +
                "<a>Il est possible de paramétrer les recherches avec des mots clés:" +
                "<ul>" +
                "   <li>serie=>RECHERCHE: permet d'effectuer la recherche seulement auprès de l'api des series/animes</li>" +
                "   <li>movie=>RECHERCHE: permet d'effectuer la recherche uniquement auprès de l'api des films ou films d'animation</li>" +
                "</ul></a>";
}