function onDocumentLoad(){new Runner(".interstitial-wrapper")}(function(){"use strict";function n(t,i){if(n.instance_)return n.instance_;n.instance_=this;this.outerContainerEl=document.querySelector(t);this.containerEl=null;this.snackbarEl=null;this.detailsButton=this.outerContainerEl.querySelector("#details-button");this.config=i||n.config;this.dimensions=n.defaultDimensions;this.canvas=null;this.canvasCtx=null;this.tRex=null;this.distanceMeter=null;this.distanceRan=0;this.highestScore=localStorage.getItem("runnerHS")||0;this.time=0;this.runningTime=0;this.msPerFrame=1e3/a;this.currentSpeed=this.config.SPEED;this.obstacles=[];this.activated=!1;this.playing=!1;this.crashed=!1;this.paused=!1;this.inverted=!1;this.invertTimer=0;this.resizeTimerId_=null;this.playCount=0;this.audioBuffer=null;this.soundFx={};this.audioContext=null;this.images={};this.imagesLoaded=0;this.isDisabled()?this.setupDisabledRunner():this.loadImages()}function h(n,t){return Math.floor(Math.random()*(t-n+1))+n}function nt(n){l&&window.navigator.vibrate&&window.navigator.vibrate(n)}function tt(t,i,r,u){var f=document.createElement("canvas");return f.className=u?n.classes.CANVAS+" "+u:n.classes.CANVAS,f.width=i,f.height=r,t.appendChild(f),f}function it(n){for(var i=n.length/4*3,u=atob(n),f=new ArrayBuffer(i),r=new Uint8Array(f),t=0;t<i;t++)r[t]=u.charCodeAt(t);return r.buffer}function c(){return w?(new Date).getTime():performance.now()}function v(n,t,i,r){this.canvas=n;this.canvasCtx=n.getContext("2d");this.canvasDimensions=r;this.textImgPos=t;this.restartImgPos=i;this.draw()}function rt(i,u,f){var p=n.defaultDimensions.WIDTH+i.xPos,s=new r(u.xPos+1,u.yPos+1,u.config.WIDTH-2,u.config.HEIGHT-2),h=new r(i.xPos+1,i.yPos+1,i.typeConfig.width*i.size-2,i.typeConfig.height-2),c,l,e,o;if(f&&k(f,s,h),d(s,h))for(c=i.collisionBoxes,l=u.ducking?t.collisionBoxes.DUCKING:t.collisionBoxes.RUNNING,e=0;e<l.length;e++)for(o=0;o<c.length;o++){var a=b(l[e],s),v=b(c[o],h),y=d(a,v);if(f&&k(f,a,v),y)return[a,v]}return!1}function b(n,t){return new r(n.x+t.x,n.y+t.y,n.width,n.height)}function k(n,t,i){n.save();n.strokeStyle="#f00";n.strokeRect(t.x,t.y,t.width,t.height);n.strokeStyle="#0f0";n.strokeRect(i.x,i.y,i.width,i.height);n.restore()}function d(n,t){var i=!1,u=n.x,f=n.y,r=t.x,e=t.y;return n.x<r+t.width&&n.x+n.width>r&&n.y<t.y+t.height&&n.height+n.y>t.y&&(i=!0),i}function r(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}function s(n,t,i,r,u,f,e){this.canvasCtx=n;this.spritePos=i;this.typeConfig=t;this.gapCoefficient=u;this.size=h(1,s.MAX_OBSTACLE_LENGTH);this.dimensions=r;this.remove=!1;this.xPos=r.WIDTH+(e||0);this.yPos=0;this.width=0;this.collisionBoxes=[];this.gap=0;this.speedOffset=0;this.currentFrame=0;this.timer=0;this.init(f)}function t(n,i){this.canvas=n;this.canvasCtx=n.getContext("2d");this.spritePos=i;this.xPos=0;this.yPos=0;this.groundYPos=0;this.currentFrame=0;this.currentAnimFrames=[];this.blinkDelay=0;this.blinkCount=0;this.animStartTime=0;this.timer=0;this.msPerFrame=1e3/a;this.config=t.config;this.status=t.status.WAITING;this.jumping=!1;this.ducking=!1;this.jumpVelocity=0;this.reachedMinHeight=!1;this.speedDrop=!1;this.jumpCount=0;this.jumpspotX=0;this.init()}function u(t,i,r){this.canvas=t;this.canvasCtx=t.getContext("2d");this.image=n.imageSprite;this.spritePos=i;this.x=0;this.y=5;this.currentDistance=0;this.maxScore=0;this.highScore=0;this.container=null;this.digits=[];this.acheivement=!1;this.defaultString="";this.flashTimer=0;this.flashIterations=0;this.invertTrigger=!1;this.config=u.config;this.maxScoreUnits=this.config.MAX_DISTANCE_UNITS;this.init(r)}function f(n,t,i){this.canvas=n;this.canvasCtx=this.canvas.getContext("2d");this.spritePos=t;this.containerWidth=i;this.xPos=i;this.yPos=0;this.remove=!1;this.cloudGap=h(f.config.MIN_CLOUD_GAP,f.config.MAX_CLOUD_GAP);this.init()}function i(n,t,i){this.spritePos=t;this.canvas=n;this.canvasCtx=n.getContext("2d");this.xPos=i-50;this.yPos=30;this.currentPhase=0;this.opacity=0;this.containerWidth=i;this.stars=[];this.drawStars=!1;this.placeStars()}function e(n,t){this.spritePos=t;this.canvas=n;this.canvasCtx=n.getContext("2d");this.sourceDimensions={};this.dimensions=e.dimensions;this.sourceXPos=[this.spritePos.x,this.spritePos.x+this.dimensions.WIDTH];this.xPos=[];this.yPos=0;this.bumpThreshold=.5;this.setSourceDimensions();this.draw()}function y(n,t,i,r){this.canvas=n;this.canvasCtx=this.canvas.getContext("2d");this.config=y.config;this.dimensions=i;this.gapCoefficient=r;this.obstacles=[];this.obstacleHistory=[];this.horizonOffsets=[0,0];this.cloudFrequency=this.config.CLOUD_FREQUENCY;this.spritePos=t;this.nightMode=null;this.clouds=[];this.cloudSpeed=this.config.BG_CLOUD_SPEED;this.horizonLine=null;this.init()}const g=["Courage !","�a me semble mal partis...","","Peu importe les d�fis sur le chemin, ne vous arr�tez pas, continuez. Vous arriverez bient�t � destination.","Restez toujours concentr�, vous y arriverez bient�t.","�levez-vous au-dessus de votre faiblesse. Le pouvoir est en vous.","N'ayez pas peur, vous avez le talent. Utilisez-le � votre avantage."];window.Runner=n;var p=600,a=60,o=window.devicePixelRatio>1,w=/iPad|iPhone|iPod/.test(window.navigator.platform),l=/Android/.test(window.navigator.userAgent)||w,ut="ontouchstart"in window;n.config={ACCELERATION:.001,BG_CLOUD_SPEED:.2,BOTTOM_PAD:10,CLEAR_TIME:3e3,CLOUD_FREQUENCY:.5,GAMEOVER_CLEAR_TIME:750,GAP_COEFFICIENT:.6,GRAVITY:.6,INITIAL_JUMP_VELOCITY:12,INVERT_FADE_DURATION:12e3,INVERT_DISTANCE:700,MAX_BLINK_COUNT:3,MAX_CLOUDS:6,MAX_OBSTACLE_LENGTH:3,MAX_OBSTACLE_DUPLICATION:2,MAX_SPEED:13,MIN_JUMP_HEIGHT:35,MOBILE_SPEED_COEFFICIENT:1.2,RESOURCE_TEMPLATE_ID:"audio-resources",SPEED:6,SPEED_DROP_COEFFICIENT:3};n.defaultDimensions={WIDTH:p,HEIGHT:150};n.classes={CANVAS:"runner-canvas",CONTAINER:"runner-container",CRASHED:"crashed",ICON:"icon-offline",INVERTED:"inverted",SNACKBAR:"snackbar",SNACKBAR_SHOW:"snackbar-show",TOUCH_CONTROLLER:"controller"};n.spriteDefinition={LDPI:{CACTUS_LARGE:{x:332,y:2},CACTUS_SMALL:{x:228,y:2},CLOUD:{x:86,y:2},HORIZON:{x:2,y:54},MOON:{x:484,y:2},PTERODACTYL:{x:134,y:2},RESTART:{x:2,y:2},TEXT_SPRITE:{x:655,y:2},TREX:{x:848,y:2},STAR:{x:645,y:2}},HDPI:{CACTUS_LARGE:{x:652,y:2},CACTUS_SMALL:{x:446,y:2},CLOUD:{x:166,y:2},HORIZON:{x:2,y:104},MOON:{x:954,y:2},PTERODACTYL:{x:260,y:2},RESTART:{x:2,y:2},TEXT_SPRITE:{x:1294,y:2},TREX:{x:1678,y:2},STAR:{x:1276,y:2}}};n.sounds={BUTTON_PRESS:"offline-sound-press",HIT:"offline-sound-hit",SCORE:"offline-sound-reached"};n.keycodes={JUMP:{"38":1,"32":1},DUCK:{"40":1},RESTART:{"13":1}};n.events={ANIM_END:"webkitAnimationEnd",CLICK:"click",KEYDOWN:"keydown",KEYUP:"keyup",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",RESIZE:"resize",TOUCHEND:"touchend",TOUCHSTART:"touchstart",VISIBILITY:"visibilitychange",BLUR:"blur",FOCUS:"focus",LOAD:"load"};n.prototype={isHighestScoreMessagePerform:!1,encouragementsEvent:0,isDisabled:function(){return!1},setupDisabledRunner:function(){this.containerEl=document.createElement("div");this.containerEl.className=n.classes.SNACKBAR;this.containerEl.textContent=loadTimeData.getValue("disabledEasterEgg");this.outerContainerEl.appendChild(this.containerEl);document.addEventListener(n.events.KEYDOWN,function(t){n.keycodes.JUMP[t.keyCode]&&(this.containerEl.classList.add(n.classes.SNACKBAR_SHOW),document.querySelector(".icon").classList.add("icon-disabled"))}.bind(this))},updateConfigSetting:function(n,t){if(n in this.config&&t!=undefined){this.config[n]=t;switch(n){case"GRAVITY":case"MIN_JUMP_HEIGHT":case"SPEED_DROP_COEFFICIENT":this.tRex.config[n]=t;break;case"INITIAL_JUMP_VELOCITY":this.tRex.setJumpVelocity(t);break;case"SPEED":this.setSpeed(t)}}},loadImages:function(){o?(n.imageSprite=document.getElementById("offline-resources-2x"),this.spriteDef=n.spriteDefinition.HDPI):(n.imageSprite=document.getElementById("offline-resources-1x"),this.spriteDef=n.spriteDefinition.LDPI);n.imageSprite.complete?this.init():n.imageSprite.addEventListener(n.events.LOAD,this.init.bind(this))},loadSounds:function(){var r,i,t,u;if(!w){this.audioContext=new AudioContext;r=document.getElementById(this.config.RESOURCE_TEMPLATE_ID).content;for(i in n.sounds)t=r.getElementById(n.sounds[i]).src,t=t.substr(t.indexOf(",")+1),u=it(t),this.audioContext.decodeAudioData(u,function(n,t){this.soundFx[n]=t}.bind(this,i))}},setSpeed:function(n){var t=n||this.currentSpeed,i;this.dimensions.WIDTH<p?(i=t*this.dimensions.WIDTH/p*this.config.MOBILE_SPEED_COEFFICIENT,this.currentSpeed=i>t?t:i):n&&(this.currentSpeed=n)},init:function(){document.querySelector("."+n.classes.ICON).style.visibility="hidden";this.adjustDimensions();this.setSpeed();this.containerEl=document.createElement("div");this.containerEl.className=n.classes.CONTAINER;this.canvas=tt(this.containerEl,this.dimensions.WIDTH,this.dimensions.HEIGHT,n.classes.PLAYER);this.canvasCtx=this.canvas.getContext("2d");this.canvasCtx.fillStyle="#f7f7f7";this.canvasCtx.fill();n.updateCanvasScaling(this.canvas);this.horizon=new y(this.canvas,this.spriteDef,this.dimensions,this.config.GAP_COEFFICIENT);this.distanceMeter=new u(this.canvas,this.spriteDef.TEXT_SPRITE,this.dimensions.WIDTH);this.highestScore>0&&this.distanceMeter.setHighScore(this.highestScore);this.distanceMeter.drawHighScore();this.tRex=new t(this.canvas,this.spriteDef.TREX);this.outerContainerEl.appendChild(this.containerEl);l&&this.createTouchController();this.startListening();this.update();window.addEventListener(n.events.RESIZE,this.debounceResize.bind(this))},createTouchController:function(){this.touchController=document.createElement("div");this.touchController.className=n.classes.TOUCH_CONTROLLER;this.outerContainerEl.appendChild(this.touchController)},debounceResize:function(){this.resizeTimerId_||(this.resizeTimerId_=setInterval(this.adjustDimensions.bind(this),250))},adjustDimensions:function(){clearInterval(this.resizeTimerId_);this.resizeTimerId_=null;var t=window.getComputedStyle(this.outerContainerEl),i=Number(t.paddingLeft.substr(0,t.paddingLeft.length-2));this.dimensions.WIDTH=this.outerContainerEl.offsetWidth-i*2;this.canvas&&(this.canvas.width=this.dimensions.WIDTH,this.canvas.height=this.dimensions.HEIGHT,n.updateCanvasScaling(this.canvas),this.distanceMeter.calcXPos(this.dimensions.WIDTH),this.clearCanvas(),this.horizon.update(0,0,!0),this.tRex.update(0),this.playing||this.crashed||this.paused?(this.containerEl.style.width=this.dimensions.WIDTH+"px",this.containerEl.style.height=this.dimensions.HEIGHT+"px",this.distanceMeter.update(0,Math.ceil(this.distanceRan)),this.stop()):this.tRex.draw(0,0),this.crashed&&this.gameOverPanel&&(this.gameOverPanel.updateDimensions(this.dimensions.WIDTH),this.gameOverPanel.draw()))},playIntro:function(){if(this.activated||this.crashed)this.crashed&&this.restart();else{this.playingIntro=!0;this.tRex.playingIntro=!0;var r="@-webkit-keyframes intro { from { width:"+t.config.WIDTH+"px }to { width: "+this.dimensions.WIDTH+"px }}",i=document.createElement("style");i.innerHTML=r;document.head.appendChild(i);this.containerEl.addEventListener(n.events.ANIM_END,this.startGame.bind(this));this.containerEl.style.webkitAnimation="intro .4s ease-out 1 both";this.containerEl.style.width=this.dimensions.WIDTH+"px";this.playing=!0;this.activated=!0}},startGame:function(){this.runningTime=0;this.playingIntro=!1;this.tRex.playingIntro=!1;this.containerEl.style.webkitAnimation="";this.playCount++;document.addEventListener(n.events.VISIBILITY,this.onVisibilityChange.bind(this));window.addEventListener(n.events.BLUR,this.onVisibilityChange.bind(this));window.addEventListener(n.events.FOCUS,this.onVisibilityChange.bind(this))},clearCanvas:function(){this.canvasCtx.clearRect(0,0,this.dimensions.WIDTH,this.dimensions.HEIGHT)},update:function(){var i,t,r,f,e,u;this.updatePending=!1;i=c();t=i-(this.time||i);this.time=i;this.playing&&(this.clearCanvas(),this.tRex.jumping&&this.tRex.updateJump(t),this.runningTime+=t,r=this.runningTime>this.config.CLEAR_TIME,this.tRex.jumpCount!=1||this.playingIntro||this.playIntro(),this.playingIntro?this.horizon.update(0,this.currentSpeed,r):(t=this.activated?t:0,this.horizon.update(t,this.currentSpeed,r,this.inverted)),f=r&&rt(this.horizon.obstacles[0],this.tRex),f?this.gameOver():(this.distanceRan+=this.currentSpeed*t/this.msPerFrame,this.currentSpeed<this.config.MAX_SPEED&&(this.currentSpeed+=this.config.ACCELERATION)),e=this.distanceMeter.update(t,Math.ceil(this.distanceRan)),e&&this.playSound(this.soundFx.SCORE),this.invertTimer>this.config.INVERT_FADE_DURATION?(this.invertTimer=0,this.invertTrigger=!1,this.invert()):this.invertTimer?this.invertTimer+=t:(u=this.distanceMeter.getActualDistance(Math.ceil(this.distanceRan)),u>0&&(this.invertTrigger=!(u%this.config.INVERT_DISTANCE),this.invertTrigger&&this.invertTimer===0&&(this.invertTimer+=t,this.invert()))));(this.playing||!this.activated&&this.tRex.blinkCount<n.config.MAX_BLINK_COUNT)&&(this.tRex.update(t),this.scheduleNextUpdate());try{if(!this.isHighestScoreMessagePerform&&LiveWidget.getLiveModel()&&this.highestScore>1&&this.highestScore<this.distanceRan&&(LiveWidget.getLiveModel().showMessage("Tu as battu ton meilleur score, BRAVO ! &#128079;",5e3,10),this.isHighestScoreMessagePerform=!0),this.distanceRan>0&&this.encouragementsEvent==0&&Math.round(this.distanceRan)%10==0){const n=Math.random()*100;if(n<=2){const n=3e3;this.encouragementsEvent=setTimeout(()=>this.encouragementsEvent=0,n);LiveWidget.getLiveModel().showMessage(randomSelection(g),n,8)}}}catch(o){}},handleEvent:function(t){return function(n,i){switch(n){case i.KEYDOWN:case i.TOUCHSTART:case i.MOUSEDOWN:this.onKeyDown(t);break;case i.KEYUP:case i.TOUCHEND:case i.MOUSEUP:this.onKeyUp(t)}}.bind(this)(t.type,n.events)},startListening:function(){document.addEventListener(n.events.KEYDOWN,this);document.addEventListener(n.events.KEYUP,this);l?(this.touchController.addEventListener(n.events.TOUCHSTART,this),this.touchController.addEventListener(n.events.TOUCHEND,this),this.containerEl.addEventListener(n.events.TOUCHSTART,this)):(document.addEventListener(n.events.MOUSEDOWN,this),document.addEventListener(n.events.MOUSEUP,this))},stopListening:function(){document.removeEventListener(n.events.KEYDOWN,this);document.removeEventListener(n.events.KEYUP,this);l?(this.touchController.removeEventListener(n.events.TOUCHSTART,this),this.touchController.removeEventListener(n.events.TOUCHEND,this),this.containerEl.removeEventListener(n.events.TOUCHSTART,this)):(document.removeEventListener(n.events.MOUSEDOWN,this),document.removeEventListener(n.events.MOUSEUP,this))},onKeyDown:function(t){l&&this.playing&&t.preventDefault();t.target!=this.detailsButton&&(!this.crashed&&(n.keycodes.JUMP[t.keyCode]||t.type==n.events.TOUCHSTART)&&(this.playing||(this.loadSounds(),this.playing=!0,this.update(),window.errorPageController&&errorPageController.trackEasterEgg()),this.tRex.jumping||this.tRex.ducking||(this.playSound(this.soundFx.BUTTON_PRESS),this.tRex.startJump(this.currentSpeed))),this.crashed&&t.type==n.events.TOUCHSTART&&t.currentTarget==this.containerEl&&this.restart());this.playing&&!this.crashed&&n.keycodes.DUCK[t.keyCode]&&(t.preventDefault(),this.tRex.jumping?this.tRex.setSpeedDrop():this.tRex.jumping||this.tRex.ducking||this.tRex.setDuck(!0))},onKeyUp:function(t){var i=String(t.keyCode),r=n.keycodes.JUMP[i]||t.type==n.events.TOUCHEND||t.type==n.events.MOUSEDOWN,u;this.isRunning()&&r?this.tRex.endJump():n.keycodes.DUCK[i]?(this.tRex.speedDrop=!1,this.tRex.setDuck(!1)):this.crashed?(u=c()-this.time,(n.keycodes.RESTART[i]||this.isLeftClickOnCanvas(t)||u>=this.config.GAMEOVER_CLEAR_TIME&&n.keycodes.JUMP[i])&&this.restart()):this.paused&&r&&(this.tRex.reset(),this.play())},isLeftClickOnCanvas:function(t){return t.button!=null&&t.button<2&&t.type==n.events.MOUSEUP&&t.target==this.canvas},scheduleNextUpdate:function(){this.updatePending||(this.updatePending=!0,this.raqId=requestAnimationFrame(this.update.bind(this)))},isRunning:function(){return!!this.raqId},gameOver:function(){this.playSound(this.soundFx.HIT);nt(200);this.stop();this.crashed=!0;this.distanceMeter.acheivement=!1;this.tRex.update(100,t.status.CRASHED);this.gameOverPanel?this.gameOverPanel.draw():this.gameOverPanel=new v(this.canvas,this.spriteDef.TEXT_SPRITE,this.spriteDef.RESTART,this.dimensions);this.distanceRan>this.highestScore?(this.highestScore=Math.ceil(this.distanceRan),localStorage.setItem("runnerHS",this.highestScore),this.distanceMeter.setHighScore(this.highestScore)):LiveWidget.getLiveModel().showMessage("Courage, tu feras mieux la prochaine fois &#x1F609; &#128170;",4e3,20);this.time=c()},stop:function(){this.playing=!1;this.paused=!0;cancelAnimationFrame(this.raqId);this.raqId=0},play:function(){this.crashed||(this.playing=!0,this.paused=!1,this.tRex.update(0,t.status.RUNNING),this.time=c(),this.update())},restart:function(){this.raqId||(this.playCount++,this.runningTime=0,this.playing=!0,this.crashed=!1,this.distanceRan=0,this.setSpeed(this.config.SPEED),this.time=c(),this.containerEl.classList.remove(n.classes.CRASHED),this.clearCanvas(),this.distanceMeter.reset(this.highestScore),this.horizon.reset(),this.tRex.reset(),this.playSound(this.soundFx.BUTTON_PRESS),this.invert(!0),this.isHighestScoreMessagePerform=!1,this.update())},onVisibilityChange:function(n){document.hidden||document.webkitHidden||n.type=="blur"||document.visibilityState!="visible"?this.stop():this.crashed||(this.tRex.reset(),this.play())},playSound:function(n){if(n){var t=this.audioContext.createBufferSource();t.buffer=n;t.connect(this.audioContext.destination);t.start(0)}},invert:function(t){t?(document.body.classList.toggle(n.classes.INVERTED,!1),this.invertTimer=0,this.inverted=!1):(this.inverted=document.body.classList.toggle(n.classes.INVERTED,this.invertTrigger),LiveWidget.getLiveModel().showMessage("Il fait nuit, j'ai peur ! &#x1F628;",4e3,15))}};n.updateCanvasScaling=function(n,t,i){var o=n.getContext("2d"),u=Math.floor(window.devicePixelRatio)||1,s=Math.floor(o.webkitBackingStorePixelRatio)||1,r=u/s,f,e;return u!==s?(f=t||n.width,e=i||n.height,n.width=f*r,n.height=e*r,n.style.width=f+"px",n.style.height=e+"px",o.scale(r,r),!0):(u==1&&(n.style.width=n.width+"px",n.style.height=n.height+"px"),!1)};v.dimensions={TEXT_X:0,TEXT_Y:13,TEXT_WIDTH:191,TEXT_HEIGHT:11,RESTART_WIDTH:36,RESTART_HEIGHT:32};v.prototype={updateDimensions:function(n,t){this.canvasDimensions.WIDTH=n;t&&(this.canvasDimensions.HEIGHT=t)},draw:function(){var t=v.dimensions,u=this.canvasDimensions.WIDTH/2,i=t.TEXT_X,r=t.TEXT_Y,f=t.TEXT_WIDTH,e=t.TEXT_HEIGHT,c=Math.round(u-t.TEXT_WIDTH/2),l=Math.round((this.canvasDimensions.HEIGHT-25)/3),a=t.TEXT_WIDTH,y=t.TEXT_HEIGHT,s=t.RESTART_WIDTH,h=t.RESTART_HEIGHT,p=u-t.RESTART_WIDTH/2,w=this.canvasDimensions.HEIGHT/2;o&&(r*=2,i*=2,f*=2,e*=2,s*=2,h*=2);i+=this.textImgPos.x;r+=this.textImgPos.y;this.canvasCtx.drawImage(n.imageSprite,i,r,f,e,c,l,a,y);this.canvasCtx.drawImage(n.imageSprite,this.restartImgPos.x,this.restartImgPos.y,s,h,p,w,t.RESTART_WIDTH,t.RESTART_HEIGHT)}};s.MAX_GAP_COEFFICIENT=1.5;s.MAX_OBSTACLE_LENGTH=3;s.prototype={init:function(n){if(this.cloneCollisionBoxes(),this.size>1&&this.typeConfig.multipleSpeed>n&&(this.size=1),this.width=this.typeConfig.width*this.size,Array.isArray(this.typeConfig.yPos)){var t=l?this.typeConfig.yPosMobile:this.typeConfig.yPos;this.yPos=t[h(0,t.length-1)]}else this.yPos=this.typeConfig.yPos;this.draw();this.size>1&&(this.collisionBoxes[1].width=this.width-this.collisionBoxes[0].width-this.collisionBoxes[2].width,this.collisionBoxes[2].x=this.width-this.collisionBoxes[2].width);this.typeConfig.speedOffset&&(this.speedOffset=Math.random()>.5?this.typeConfig.speedOffset:-this.typeConfig.speedOffset);this.gap=this.getGap(this.gapCoefficient,n)},draw:function(){var t=this.typeConfig.width,i=this.typeConfig.height,r;o&&(t=t*2,i=i*2);r=t*this.size*.5*(this.size-1)+this.spritePos.x;this.currentFrame>0&&(r+=t*this.currentFrame);this.canvasCtx.drawImage(n.imageSprite,r,this.spritePos.y,t*this.size,i,this.xPos,this.yPos,this.typeConfig.width*this.size,this.typeConfig.height)},update:function(n,t){this.remove||(this.typeConfig.speedOffset&&(t+=this.speedOffset),this.xPos-=Math.floor(t*a/1e3*n),this.typeConfig.numFrames&&(this.timer+=n,this.timer>=this.typeConfig.frameRate&&(this.currentFrame=this.currentFrame==this.typeConfig.numFrames-1?0:this.currentFrame+1,this.timer=0)),this.draw(),this.isVisible()||(this.remove=!0))},getGap:function(n,t){var i=Math.round(this.width*t+this.typeConfig.minGap*n),r=Math.round(i*s.MAX_GAP_COEFFICIENT);return h(i,r)},isVisible:function(){return this.xPos+this.width>0},cloneCollisionBoxes:function(){for(var t=this.typeConfig.collisionBoxes,n=t.length-1;n>=0;n--)this.collisionBoxes[n]=new r(t[n].x,t[n].y,t[n].width,t[n].height)}};s.types=[{type:"CACTUS_SMALL",width:17,height:35,yPos:105,multipleSpeed:4,minGap:120,minSpeed:0,collisionBoxes:[new r(0,7,5,27),new r(4,0,6,34),new r(10,4,7,14)]},{type:"CACTUS_LARGE",width:25,height:50,yPos:90,multipleSpeed:7,minGap:120,minSpeed:0,collisionBoxes:[new r(0,12,7,38),new r(8,0,7,49),new r(13,10,10,38)]},{type:"PTERODACTYL",width:46,height:40,yPos:[100,75,50],yPosMobile:[100,50],multipleSpeed:999,minSpeed:8.5,minGap:150,collisionBoxes:[new r(15,15,16,5),new r(18,21,24,6),new r(2,14,4,3),new r(6,10,4,7),new r(10,8,6,9)],numFrames:2,frameRate:1e3/6,speedOffset:.8}];t.config={DROP_VELOCITY:-5,GRAVITY:.6,HEIGHT:47,HEIGHT_DUCK:25,INIITAL_JUMP_VELOCITY:-10,INTRO_DURATION:1500,MAX_JUMP_HEIGHT:30,MIN_JUMP_HEIGHT:30,SPEED_DROP_COEFFICIENT:3,SPRITE_WIDTH:262,START_X_POS:50,WIDTH:44,WIDTH_DUCK:59};t.collisionBoxes={DUCKING:[new r(1,18,55,25)],RUNNING:[new r(22,0,17,16),new r(1,18,30,9),new r(10,35,14,8),new r(1,24,29,5),new r(5,30,21,4),new r(9,34,15,4)]};t.status={CRASHED:"CRASHED",DUCKING:"DUCKING",JUMPING:"JUMPING",RUNNING:"RUNNING",WAITING:"WAITING"};t.BLINK_TIMING=7e3;t.animFrames={WAITING:{frames:[44,0],msPerFrame:1e3/3},RUNNING:{frames:[88,132],msPerFrame:1e3/12},CRASHED:{frames:[220],msPerFrame:1e3/60},JUMPING:{frames:[0],msPerFrame:1e3/60},DUCKING:{frames:[264,323],msPerFrame:125}};t.prototype={init:function(){this.groundYPos=n.defaultDimensions.HEIGHT-this.config.HEIGHT-n.config.BOTTOM_PAD;this.yPos=this.groundYPos;this.minJumpHeight=this.groundYPos-this.config.MIN_JUMP_HEIGHT;this.draw(0,0);this.update(0,t.status.WAITING)},setJumpVelocity:function(n){this.config.INIITAL_JUMP_VELOCITY=-n;this.config.DROP_VELOCITY=-n/2},update:function(n,i){this.timer+=n;i&&(this.status=i,this.currentFrame=0,this.msPerFrame=t.animFrames[i].msPerFrame,this.currentAnimFrames=t.animFrames[i].frames,i==t.status.WAITING&&(this.animStartTime=c(),this.setBlinkDelay()));this.playingIntro&&this.xPos<this.config.START_X_POS&&(this.xPos+=Math.round(this.config.START_X_POS/this.config.INTRO_DURATION*n));this.status==t.status.WAITING?this.blink(c()):this.draw(this.currentAnimFrames[this.currentFrame],0);this.timer>=this.msPerFrame&&(this.currentFrame=this.currentFrame==this.currentAnimFrames.length-1?0:this.currentFrame+1,this.timer=0);this.speedDrop&&this.yPos==this.groundYPos&&(this.speedDrop=!1,this.setDuck(!0))},draw:function(i,r){var u=i,f=r,e=this.ducking&&this.status!=t.status.CRASHED?this.config.WIDTH_DUCK:this.config.WIDTH,s=this.config.HEIGHT;o&&(u*=2,f*=2,e*=2,s*=2);u+=this.spritePos.x;f+=this.spritePos.y;this.ducking&&this.status!=t.status.CRASHED?this.canvasCtx.drawImage(n.imageSprite,u,f,e,s,this.xPos,this.yPos,this.config.WIDTH_DUCK,this.config.HEIGHT):(this.ducking&&this.status==t.status.CRASHED&&this.xPos++,this.canvasCtx.drawImage(n.imageSprite,u,f,e,s,this.xPos,this.yPos,this.config.WIDTH,this.config.HEIGHT))},setBlinkDelay:function(){this.blinkDelay=Math.ceil(Math.random()*t.BLINK_TIMING)},blink:function(n){var t=n-this.animStartTime;t>=this.blinkDelay&&(this.draw(this.currentAnimFrames[this.currentFrame],0),this.currentFrame==1&&(this.setBlinkDelay(),this.animStartTime=n,this.blinkCount++))},startJump:function(n){this.jumping||(this.update(0,t.status.JUMPING),this.jumpVelocity=this.config.INIITAL_JUMP_VELOCITY-n/10,this.jumping=!0,this.reachedMinHeight=!1,this.speedDrop=!1)},endJump:function(){this.reachedMinHeight&&this.jumpVelocity<this.config.DROP_VELOCITY&&(this.jumpVelocity=this.config.DROP_VELOCITY)},updateJump:function(n){var r=t.animFrames[this.status].msPerFrame,i=n/r;this.yPos+=this.speedDrop?Math.round(this.jumpVelocity*this.config.SPEED_DROP_COEFFICIENT*i):Math.round(this.jumpVelocity*i);this.jumpVelocity+=this.config.GRAVITY*i;(this.yPos<this.minJumpHeight||this.speedDrop)&&(this.reachedMinHeight=!0);(this.yPos<this.config.MAX_JUMP_HEIGHT||this.speedDrop)&&this.endJump();this.yPos>this.groundYPos&&(this.reset(),this.jumpCount++);this.update(n)},setSpeedDrop:function(){this.speedDrop=!0;this.jumpVelocity=1},setDuck:function(n){n&&this.status!=t.status.DUCKING?(this.update(0,t.status.DUCKING),this.ducking=!0):this.status==t.status.DUCKING&&(this.update(0,t.status.RUNNING),this.ducking=!1)},reset:function(){this.yPos=this.groundYPos;this.jumpVelocity=0;this.jumping=!1;this.ducking=!1;this.update(0,t.status.RUNNING);this.midair=!1;this.speedDrop=!1;this.jumpCount=0}};u.dimensions={WIDTH:10,HEIGHT:13,DEST_WIDTH:11};u.yPos=[0,13,27,40,53,67,80,93,107,120];u.config={MAX_DISTANCE_UNITS:5,ACHIEVEMENT_DISTANCE:100,COEFFICIENT:.025,FLASH_DURATION:250,FLASH_ITERATIONS:3};u.prototype={init:function(n){var i="",t;for(this.calcXPos(n),this.maxScore=this.maxScoreUnits,t=0;t<this.maxScoreUnits;t++)this.draw(t,0),this.defaultString+="0",i+="9";this.maxScore=parseInt(i)},calcXPos:function(n){this.x=n-u.dimensions.DEST_WIDTH*(this.maxScoreUnits+1)},draw:function(n,t,i){var f=u.dimensions.WIDTH,e=u.dimensions.HEIGHT,r=u.dimensions.WIDTH*t,s=0,c=n*u.dimensions.DEST_WIDTH,l=this.y,a=u.dimensions.WIDTH,v=u.dimensions.HEIGHT,h;o&&(f*=2,e*=2,r*=2);r+=this.spritePos.x;s+=this.spritePos.y;this.canvasCtx.save();i?(h=this.x-this.maxScoreUnits*2*u.dimensions.WIDTH,this.canvasCtx.translate(h,this.y)):this.canvasCtx.translate(this.x,this.y);this.canvasCtx.drawImage(this.image,r,s,f,e,c,l,a,v);this.canvasCtx.restore()},getActualDistance:function(n){return n?Math.round(n*this.config.COEFFICIENT):0},update:function(n,t){var r=!0,u=!1,f,i;if(this.acheivement?this.flashIterations<=this.config.FLASH_ITERATIONS?(this.flashTimer+=n,this.flashTimer<this.config.FLASH_DURATION?r=!1:this.flashTimer>this.config.FLASH_DURATION*2&&(this.flashTimer=0,this.flashIterations++)):(this.acheivement=!1,this.flashIterations=0,this.flashTimer=0):(t=this.getActualDistance(t),t>this.maxScore&&this.maxScoreUnits==this.config.MAX_DISTANCE_UNITS?(this.maxScoreUnits++,this.maxScore=parseInt(this.maxScore+"9")):this.distance=0,t>0?(t%this.config.ACHIEVEMENT_DISTANCE==0&&(this.acheivement=!0,this.flashTimer=0,u=!0),f=(this.defaultString+t).substr(-this.maxScoreUnits),this.digits=f.split("")):this.digits=this.defaultString.split("")),r)for(i=this.digits.length-1;i>=0;i--)this.draw(i,parseInt(this.digits[i]));return this.drawHighScore(),u},drawHighScore:function(){this.canvasCtx.save();this.canvasCtx.globalAlpha=.8;for(var n=this.highScore.length-1;n>=0;n--)this.draw(n,parseInt(this.highScore[n],10),!0);this.canvasCtx.restore()},setHighScore:function(n){n=this.getActualDistance(n);var t=(this.defaultString+n).substr(-this.maxScoreUnits);this.highScore=["10","11",""].concat(t.split(""))},reset:function(){this.update(0);this.acheivement=!1}};f.config={HEIGHT:14,MAX_CLOUD_GAP:400,MAX_SKY_LEVEL:30,MIN_CLOUD_GAP:100,MIN_SKY_LEVEL:71,WIDTH:46};f.prototype={init:function(){this.yPos=h(f.config.MAX_SKY_LEVEL,f.config.MIN_SKY_LEVEL);this.draw()},draw:function(){this.canvasCtx.save();var t=f.config.WIDTH,i=f.config.HEIGHT;o&&(t=t*2,i=i*2);this.canvasCtx.drawImage(n.imageSprite,this.spritePos.x,this.spritePos.y,t,i,this.xPos,this.yPos,f.config.WIDTH,f.config.HEIGHT);this.canvasCtx.restore()},update:function(n){this.remove||(this.xPos-=Math.ceil(n),this.draw(),this.isVisible()||(this.remove=!0))},isVisible:function(){return this.xPos+f.config.WIDTH>0}};i.config={FADE_SPEED:.035,HEIGHT:40,MOON_SPEED:.25,NUM_STARS:2,STAR_SIZE:9,STAR_SPEED:.3,STAR_MAX_Y:70,WIDTH:20};i.phases=[140,120,100,60,40,20,0];i.prototype={update:function(n){if(n&&this.opacity==0&&(this.currentPhase++,this.currentPhase>=i.phases.length&&(this.currentPhase=0)),n&&(this.opacity<1||this.opacity==0)?this.opacity+=i.config.FADE_SPEED:this.opacity>0&&(this.opacity-=i.config.FADE_SPEED),this.opacity>0){if(this.xPos=this.updateXPos(this.xPos,i.config.MOON_SPEED),this.drawStars)for(var t=0;t<i.config.NUM_STARS;t++)this.stars[t].x=this.updateXPos(this.stars[t].x,i.config.STAR_SPEED);this.draw()}else this.opacity=0,this.placeStars();this.drawStars=!0},updateXPos:function(n,t){return n<-i.config.WIDTH?n=this.containerWidth:n-=t,n},draw:function(){var r=this.currentPhase==3?i.config.WIDTH*2:i.config.WIDTH,f=i.config.HEIGHT,e=this.spritePos.x+i.phases[this.currentPhase],h=r,u=i.config.STAR_SIZE,s=n.spriteDefinition.LDPI.STAR.x,t;if(o&&(r*=2,f*=2,e=this.spritePos.x+i.phases[this.currentPhase]*2,u*=2,s=n.spriteDefinition.HDPI.STAR.x),this.canvasCtx.save(),this.canvasCtx.globalAlpha=this.opacity,this.drawStars)for(t=0;t<i.config.NUM_STARS;t++)this.canvasCtx.drawImage(n.imageSprite,s,this.stars[t].sourceY,u,u,Math.round(this.stars[t].x),this.stars[t].y,i.config.STAR_SIZE,i.config.STAR_SIZE);this.canvasCtx.drawImage(n.imageSprite,e,this.spritePos.y,r,f,Math.round(this.xPos),this.yPos,h,i.config.HEIGHT);this.canvasCtx.globalAlpha=1;this.canvasCtx.restore()},placeStars:function(){for(var r=Math.round(this.containerWidth/i.config.NUM_STARS),t=0;t<i.config.NUM_STARS;t++)this.stars[t]={},this.stars[t].x=h(r*t,r*(t+1)),this.stars[t].y=h(0,i.config.STAR_MAX_Y),this.stars[t].sourceY=o?n.spriteDefinition.HDPI.STAR.y+i.config.STAR_SIZE*2*t:n.spriteDefinition.LDPI.STAR.y+i.config.STAR_SIZE*t},reset:function(){this.currentPhase=0;this.opacity=0;this.update(!1)}};e.dimensions={WIDTH:600,HEIGHT:12,YPOS:127};e.prototype={setSourceDimensions:function(){for(var n in e.dimensions)o?n!="YPOS"&&(this.sourceDimensions[n]=e.dimensions[n]*2):this.sourceDimensions[n]=e.dimensions[n],this.dimensions[n]=e.dimensions[n];this.xPos=[0,e.dimensions.WIDTH];this.yPos=e.dimensions.YPOS},getRandomType:function(){return Math.random()>this.bumpThreshold?this.dimensions.WIDTH:0},draw:function(){this.canvasCtx.drawImage(n.imageSprite,this.sourceXPos[0],this.spritePos.y,this.sourceDimensions.WIDTH,this.sourceDimensions.HEIGHT,this.xPos[0],this.yPos,this.dimensions.WIDTH,this.dimensions.HEIGHT);this.canvasCtx.drawImage(n.imageSprite,this.sourceXPos[1],this.spritePos.y,this.sourceDimensions.WIDTH,this.sourceDimensions.HEIGHT,this.xPos[1],this.yPos,this.dimensions.WIDTH,this.dimensions.HEIGHT)},updateXPos:function(n,t){var i=n,r=n==0?1:0;this.xPos[i]-=t;this.xPos[r]=this.xPos[i]+this.dimensions.WIDTH;this.xPos[i]<=-this.dimensions.WIDTH&&(this.xPos[i]+=this.dimensions.WIDTH*2,this.xPos[r]=this.xPos[i]-this.dimensions.WIDTH,this.sourceXPos[i]=this.getRandomType()+this.spritePos.x)},update:function(n,t){var i=Math.floor(t*(a/1e3)*n);this.xPos[0]<=0?this.updateXPos(0,i):this.updateXPos(1,i);this.draw()},reset:function(){this.xPos[0]=0;this.xPos[1]=e.dimensions.WIDTH}};y.config={BG_CLOUD_SPEED:.2,BUMPY_THRESHOLD:.3,CLOUD_FREQUENCY:.5,HORIZON_HEIGHT:16,MAX_CLOUDS:6};y.prototype={init:function(){this.addCloud();this.horizonLine=new e(this.canvas,this.spritePos.HORIZON);this.nightMode=new i(this.canvas,this.spritePos.MOON,this.dimensions.WIDTH)},update:function(n,t,i,r){this.runningTime+=n;this.horizonLine.update(n,t);this.nightMode.update(r);this.updateClouds(n,t);i&&this.updateObstacles(n,t)},updateClouds:function(n,t){var f=this.cloudSpeed/1e3*n*t,i=this.clouds.length,r,u;if(i){for(r=i-1;r>=0;r--)this.clouds[r].update(f);u=this.clouds[i-1];i<this.config.MAX_CLOUDS&&this.dimensions.WIDTH-u.xPos>u.cloudGap&&this.cloudFrequency>Math.random()&&this.addCloud();this.clouds=this.clouds.filter(function(n){return!n.remove})}else this.addCloud()},updateObstacles:function(n,t){for(var u,i,f=this.obstacles.slice(0),r=0;r<this.obstacles.length;r++)u=this.obstacles[r],u.update(n,t),u.remove&&f.shift();this.obstacles=f;this.obstacles.length>0?(i=this.obstacles[this.obstacles.length-1],i&&!i.followingObstacleCreated&&i.isVisible()&&i.xPos+i.width+i.gap<this.dimensions.WIDTH&&(this.addNewObstacle(t),i.followingObstacleCreated=!0)):this.addNewObstacle(t)},removeFirstObstacle:function(){this.obstacles.shift()},addNewObstacle:function(t){var u=h(0,s.types.length-1),i=s.types[u],r;this.duplicateObstacleCheck(i.type)||t<i.minSpeed?this.addNewObstacle(t):(r=this.spritePos[i.type],this.obstacles.push(new s(this.canvasCtx,i,r,this.dimensions,this.gapCoefficient,t,i.width)),this.obstacleHistory.unshift(i.type),this.obstacleHistory.length>1&&this.obstacleHistory.splice(n.config.MAX_OBSTACLE_DUPLICATION))},duplicateObstacleCheck:function(t){for(var i=0,r=0;r<this.obstacleHistory.length;r++)i=this.obstacleHistory[r]==t?i+1:0;return i>=n.config.MAX_OBSTACLE_DUPLICATION},reset:function(){this.obstacles=[];this.horizonLine.reset();this.nightMode.reset()},resize:function(n,t){this.canvas.width=n;this.canvas.height=t},addCloud:function(){this.clouds.push(new f(this.canvas,this.spritePos.CLOUD,this.dimensions.WIDTH))}}})();document.addEventListener("DOMContentLoaded",onDocumentLoad);