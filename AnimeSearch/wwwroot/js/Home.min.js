function swapNodes(n,t){var u=n.parentNode,r=t.parentNode,i=t.nextSibling;return i===n&&(i=i.nextSibling),u.replaceChild(t,n),i?r.insertBefore(n,i):r.appendChild(n),!0}function keyPress(n){var r=$("#propositions").children().length,i,t,u,f;n.keyCode==40&&tab_index==r-1&&(tab_index=-1);n.keyCode==38&&tab_index==0&&(tab_index=r);tab_index=tab_index+(n.keyCode==40?1:n.keyCode==38?-1:0);i=$("#"+tab_index);t=$("#propositions");i.addClass("element_liste_hover");u=i.position().top+i.height();f=t.position().top+t.height();u>f&&t.scrollTop(t.scrollTop()+i.height()*2);u<t.position().top&&t.scrollTop(t.scrollTop()-i.height()*2);tab_index==0&&t.scrollTop(0);tab_index==r-1&&t.scrollTop(9999);resetLiClass()}function resetLiClass(){for(var n=0;n<$("#propositions")[0].childNodes.length;)n!=tab_index&&$("#"+n).attr("class","propositions-item row"),n=n+1}function mouseX(n){return n.pageX?n.pageX:n.clientX?n.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):null}function mouseY(n){return n.pageY?n.pageY:n.clientY?n.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):null}var controle,tab_index;$(document).ready(function(){var t=$.get(""),i=t,n=$("#propositions"),r=$("#urlbase").attr("href");$("#searchBar").keypress(function(){(event.keyCode==40||event.keyCode==38||event.keyCode==13)&&tab_index>=0&&$("#propositions").css("display")=="block"&&$("#propositions")[0].childNodes.length>0&&event.preventDefault()});$("#searchBar").keyup(function(n){(n.keyCode==40||n.keyCode==38||n.keyCode==13)&&(n.preventDefault(),keyPress(n),n.keyCode==13&&$("#"+tab_index).trigger("click"))});$("#searchBar").on("input",function(){if(t!=null&&t.abort(),i!=null&&i.abort(),this.value.length>2){var u=this.value,f=u.indexOf("=>");if(f>0&&(u=u.substring(f+2)),u.length<=2){n.hide("fast");return}t=$.get("https://api.tvmaze.com/search/shows?q="+u,function(i){n.empty();var r=0;$.each(i,function(t,i){var u=$("<a>").text(i.show.name).addClass(["propositions-item","row"]).attr("id",r++);u.click(function(){$("#searchBar").val(this.innerText);n.empty();n.hide("fast");$("#searchBar").focus();tab_index=-1;resetLiClass()});n.append(u)});r>0&&n.show("fast");t=null});i=$.get(r+"api/films/"+u,function(t){var r=n[0].childElementCount;$.each(t,function(t,i){var u=$("<a>").text(i.name).addClass(["propositions-item","row"]).attr("id",r++);u.click(function(){$("#searchBar").val(this.innerText);n.empty();n.hide("fast");$("#searchBar").focus();tab_index=-1;resetLiClass()});n.append(u)});r>0&&n.show("fast");i=null})}else n.empty(),n.hide("fast");n[0].childNodes.length<1&&(tab_index=-1,n.hide("fast"))});$("#searchBar").focusin(function(){n.show("fast")});$(document).click(function(t){$(t.target).hasClass("propositions-item")||t.target.id=="searchBar"||(tab_index=-1,n.hide("fast"),resetLiClass())});$("#btnOK").click(function(){var n="";$("tr").each(function(){n+=this.id+"|"});eraseCookie("languageOrder");createCookie("languageOrder",n)});$(".search_icon").on("contextmenu",function(){$(".dcm").show("fast");var n=$("#rmenu");return n[0].style.top=mouseY(event)+"px",n[0].style.left=mouseX(event)+"px",!1});$(".dcm").click(function(){$(this).hide("fast");$("#rmenu").hide("fast")});$("#valCit").click(function(){var t={contenue:$("#contenue").val(),authorName:$("#auteur").val()},n={title:"Titre test",confirmButtonText:"Ok"};$.post(r+"api/citation",t,function(t){$("#contenue").val("");$("#auteur").val("");n.title=t;n.icon="success";SwalFire(n)}).fail(function(t){n.title=t.responseText;n.icon="error";SwalFire(n)})});$("#dform").submit(function(){let n=$("#loading");n.show("fast");n.focus()})});var allowDrop=function(n){n.preventDefault()},drag=function(n){n.dataTransfer.setData("text",n.target.id)},drop=function(n){n.preventDefault();var t=document.getElementById(n.dataTransfer.getData("text")),i=document.getElementById(n.currentTarget.id);swapNodes(t,i)};controle=!1;tab_index=-1;