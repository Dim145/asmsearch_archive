var tabSearch=["one piece","naruto","fairy tail","bleach","lucifer","black clover","black mirror","nanatsu no taizai","attaque des titans"],indexSearch=0;$(document).ready(function(){function r(n){var t=n.originalEvent.clipboardData.getData("text")+"";t.startsWith("http")&&($(this).val(t.substr(t.indexOf("//")+2)),n.preventDefault())}function u(n=-1){for(var r,t,u={},f=$("#POST-values").children().length,i=0;i<f;i++)r=$("#name"+i).val(),t=$("#val"+i).val(),r!=""&&r!=undefined&&t!=undefined&&t!=""&&(t=="?"&&(t=n!=-1?tabSearch[n]:null),u[r]=t);return u}function f(n){var t=indexSearch++,r=u(t);$.post(i+"GetHTMLSite?url="+encodeURIComponent(n+(n.endsWith("=")?tabSearch[t]:"")),r,function(n){$("#site").text("");$("#site").append(n);$("#dataSearch").text(tabSearch[t])}).fail(function(){SwalFire({title:"Erreur lors du chargement du site saisi.",icon:"error",confirmButtonText:"Ok"})});indexSearch>=tabSearch.length&&(indexSearch=0)}function t(){var i=!0,t;$.each(n,function(n,t){t[0].validity.valid||(i=!1)});i?$("#valider")[0]==undefined&&(t=$("<button>").attr("id","valider").addClass(["btn","btn-dark","btn-outline-light"]).text("Valider"),$("#valid-Zone").append(t),t.click(e)):$("#valider").remove()}function e(){var t={url:$("#httpType").val()+n[0].val(),urlSearch:n[1].val(),urlIcon:$("#httpTypeIcon").val()+n[2].val(),title:n[3].val(),typeSite:n[4].val(),cheminBaliseA:n[5].val(),idBase:n[6].val(),postValues:u(-1),is_inter:$("#lang").is(":checked")};$.post(i+"api/addSite",t,function(n){SwalFire({title:n,icon:"success",confirmButtonText:"Ok"})}).fail(function(n){SwalFire({title:n.responseText,icon:"error",confirmButtonText:"Ok"})})}var n=[$("#baseURL"),$("#searchURL"),$("#iconURL"),$("#siteTitle"),$("#type"),$("#cheminElt"),$("#idDoc")],i=$("#urlbase").attr("href");n[0].focusout(function(){var r=$(this),u=$("#httpType").val();u+=r.val();$.get(i+"testURL?url="+encodeURIComponent(u),function(){r[0].setCustomValidity("");t()}).fail(function(){r[0].setCustomValidity("adresse inateignable");n[1][0].setCustomValidity("adresse inateignable");t();$("#btnDiv").hide("fast")})});n[0].on("paste",r);n[1].focusout(function(){var u=$(this).val(),o=$("#POST-values").children().length,e,r;(u==""||u==undefined)&&o<=0?(t(),$("#btnDiv").hide("fast")):(e=this,r=$("#httpType").val(),r+=n[0].val()+"/"+u,$.get(i+"testURL?url="+encodeURIComponent(r),function(){e.setCustomValidity("");t();f(r);$("#btnDiv").show("fast")}).fail(function(){e.setCustomValidity("adresse inateignable");t();$("#btnDiv").hide("fast")}))});n[2].focusout(function(){var n=this,r=$("#httpTypeIcon").val()+$(this).val();$.get(i+"testURL?url="+encodeURIComponent(r),function(){$("#imageIcon").attr("src",r);n.setCustomValidity("");t()}).fail(function(){$("#imageIcon").attr("src","");n.setCustomValidity("adresse inateignable");t()});t()});n[2].on("paste",r);n[3].focusout(function(){t()});n[4].focusout(function(){t()});n[5].focusout(function(){t()});n[6].focusout(function(){t()});$("#dialogIframe").on("hidden.bs.modal",function(){t()});$("#dialogPOST").on("hidden.bs.modal",function(){t();n[1].focus();$(this).focus()});$("#site").click(function(t){var i,u,f,r;for($("#btnFermer").click(),i=$(t.target),u="",t.preventDefault();i[0]!=undefined&&i[0].id!="site"&&i[0].localName!="body";)i[0].localName!=undefined&&(f="/"+i[0].localName,r=i.attr("class"),r!=undefined&&r!=""&&r.indexOf(" ")<=0&&r.indexOf("-")<=0&&(f+="[@class='"+r+"']"),u=f+u),i=i.parent();n[5].val(u.substr(1));n[6].val("")});$("#research").click(function(){var t=$("#httpType").val();t+=n[0].val()+"/"+n[1].val();f(t)});$("#addPOST").click(function(){var n=$("<tr>"),t=$("#POST-values"),i=t.children().length;n.append($("<td>").append($("<input>").addClass("w-100").attr("id","name"+i)));n.append($("<td>").append($("<input>").addClass("w-100").attr("id","val"+i)));t.append(n)})});